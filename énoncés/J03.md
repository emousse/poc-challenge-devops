# Continuous Deployment

Ce challenge se concentre sur le d√©ploiement continu du **frontend**. Vous devriez avoir une application frontend (celle des challenges pr√©c√©dents ou une autre) pr√™te √† √™tre build√©e et d√©ploy√©e.

## üéØ Objectifs P√©dagogiques

*   **Comprendre** le concept de Continuous Integration / Continuous Deployment (CI/CD) en pratique.
*   **Appliquer** la cr√©ation d'un pipeline de d√©ploiement simple avec GitHub Actions.
*   **Utiliser** des actions du Marketplace GitHub (ex: `actions/checkout`, `actions/setup-node`).
*   **G√©rer** des secrets dans GitHub Actions pour des informations sensibles (token d'API).
*   **D√©ployer** une application frontend statique en ligne en utilisant Surge.sh.

## üìã Contexte du projet

*   **Votre application frontend :**
*   **Un compte GitHub :** Votre projet doit √™tre h√©berg√© sur GitHub pour utiliser GitHub Actions.
*   **Un compte Surge.sh :** Vous aurez besoin de cr√©er un compte gratuit sur [Surge.sh](https://surge.sh/) et d'obtenir un token d'authentification.

## üöÄ Votre Mission

Votre mission est de configurer un workflow GitHub Actions qui d√©ploie automatiquement votre application frontend sur Surge.sh √† chaque fois que des modifications sont pouss√©es (`push`) sur la branche `main` de votre d√©p√¥t GitHub.

### 1. Pr√©paration de Surge.sh

1.  **Cr√©ez un compte sur Surge.sh :**
    *   Si vous ne l'avez pas d√©j√†, installez Surge CLI globalement : `npm install --global surge`
    *   Cr√©ez un compte : `surge login` (suivez les instructions).
2.  **Obtenez votre token Surge :**
    *   Une fois connect√©, ex√©cutez : `surge token`
    *   Copiez ce token, vous en aurez besoin pour les secrets GitHub.
3.  **Choisissez un sous-domaine pour votre site :**
    *   Pensez √† un nom de domaine unique pour votre d√©ploiement sur Surge (ex: `mon-super-frontend-saison-devops.surge.sh`). Vous l'utiliserez dans votre workflow.

### 2. Configuration des secrets GitHub

Dans votre d√©p√¥t GitHub, allez dans `Settings > Secrets and variables > Actions` et ajoutez les secrets suivants :

*   `SURGE_TOKEN` : Collez le token obtenu √† l'√©tape pr√©c√©dente.
*   `SURGE_DOMAIN` : Entrez le sous-domaine complet que vous avez choisi pour Surge.sh (ex: `mon-super-frontend-saison-devops.surge.sh`).

### 3. Cr√©ation du workflow GitHub Actions

Cr√©ez un fichier de workflow dans votre d√©p√¥t √† l'emplacement `.github/workflows/deploy-frontend.yml` (ou un nom similaire).

Ce workflow devra effectuer les actions suivantes :

1.  **D√©clencheur (`on`) :**
    *   Se d√©clencher √† chaque `push` sur la branche `main`.

2.  **Job de D√©ploiement (`deploy`) :**
    *   S'ex√©cuter sur un runner `ubuntu-latest`.
    *   **√âtapes (`steps`) :**
        1.  **R√©cup√©rer le code source :** Utiliser l'action `actions/checkout@v4` (ou la derni√®re version).
        2.  **Mettre en place Node.js :** Utiliser l'action `actions/setup-node@v4` (ou la derni√®re version) pour installer une version LTS de Node.js (ex: 18.x ou 20.x). Activer le cache `npm`.
        3.  **Installer les d√©pendances :** Ex√©cuter `npm ci` (ou `yarn install --frozen-lockfile`).
        4.  **(Optionnel mais recommand√©) Ex√©cuter les tests :** Ex√©cuter `npm test` (si votre projet a des tests).
        5.  **Builder l'application frontend :** Ex√©cuter `npm run build`. Cela devrait g√©n√©rer les fichiers statiques dans un r√©pertoire (ex: `dist/`).
        6.  **D√©ployer sur Surge.sh :**
            *   Installer Surge CLI : `npm install --global surge`.
            *   Ex√©cuter la commande `surge` en utilisant les secrets configur√©s. La commande devrait ressembler √† :
                ```bash
                surge --project ./dist --domain ${{ secrets.SURGE_DOMAIN }} --token ${{ secrets.SURGE_TOKEN }}
                ```
                (Adaptez `./dist` si votre dossier de build a un autre nom).

## ‚úÖ Checklist

- [ ] Un fichier de workflow `.github/workflows/deploy-frontend.yml` (ou similaire) est pr√©sent et correctement configur√©.
- [ ] Les secrets `SURGE_TOKEN` et `SURGE_DOMAIN` sont correctement configur√©s dans les param√®tres du d√©p√¥t GitHub.
- [ ] Lors d'un `push` sur la branche `main`, le workflow GitHub Actions se d√©clenche automatiquement.
- [ ] Toutes les √©tapes du workflow (checkout, setup node, install, build, deploy) s'ex√©cutent avec succ√®s.
- [ ] L'application frontend est d√©ploy√©e et accessible publiquement sur l'URL Surge.sh que vous avez configur√©e (ex: `http://<votre-domaine>.surge.sh`).
- [ ] Les modifications apport√©es au code du frontend et pouss√©es sur `main` sont automatiquement refl√©t√©es sur le site d√©ploy√© apr√®s l'ex√©cution du workflow.

## üéÅ Bonus

*   **D√©ploiement conditionnel :** Modifiez le workflow pour qu'il ne se d√©ploie que si les tests (si vous en avez) passent.
*   **D√©ploiement sur Pull Request Merg√©e :** Modifiez le d√©clencheur du workflow pour qu'il d√©ploie uniquement lorsqu'une Pull Request est ferm√©e ET merg√©e sur la branche `main`.
    *   Indice : `on: pull_request: types: [closed]` et une condition `if: github.event.pull_request.merged == true`.

Bonne automatisation !

